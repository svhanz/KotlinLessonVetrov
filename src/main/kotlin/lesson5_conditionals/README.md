# IF ELSE WHEN В KOTLIN ОПЕРАТОРЫ ВЕТВЛЕНИЯ ИЛИ УСЛОВНЫЕ ОПЕРАТОРЫ

---

## Оператор if else

Напомню гипотетический сценарий программы: при определенном пороге возраста нужно показывать страницу со скрытым контентом.<br>
Это ничто иное как условие. Мы говорим — “Если возраст больше или равен 18, то надо сделать какое-то действие”.<br>
Условиями напичкана любая программа, поэтому эта тема является базовым столпом по основам программирования.

Для созданий условий в языке Kotlin есть специальная конструкция `if`, которая буквально пишется также, как и произносится.

Если возраст пользователя больше или равен 18, выполнить действие распечатки в консоль сообщения — “Показать экран со скрытым контентом”.<br>
Действие внутри фигурных скобок выполнится, только если выражение в круглых скобках вернет true.<br>
В противном случае программа не зайдет внутрь фигурных скобок и не выполнит код:
```html
val userAge = 42

if(userAge >= AGE_OF_MAJORITY) {
    println("Показать экран со скрытым контентом")
}

const val AGE_OF_MAJORITY = 18
const val RETIREMENT_AGE = 65
```
Для демонстрации этого добавим еще одно условие `if`.<br>
Если возраст меньше 18, то, допустим, нужно будет вернуть пользователя на главный экран приложения:
```html
if(userAge < AGE_OF_MAJORITY) {
    println("Вернуться на главный экран приложения")
}
```
Кстати, усовершенствуем программу функцией ввода данных с клавиатуры.<br>
Чтобы не менять руками переменную `userAge` при каждом тестировании.<br>
Для этого вызовем функцию `readLine()`, которая, при запуске программы,<br>
вызовет чтение данных из консоли и будет сохранять все что введено в переменную userAge.<br>
Но по умолчанию эта функция сохраняет данные в виде строки, а мы работаем с числами.<br>
Во избежание ошибки необходимо добавить вызов еще одной функции `toInt()`.<br>
На восклицательные знаки пока не обращаем внимания.

`toInt()` запустит преобразование (или конвертацию) строки типа `String` в целое число типа `Int`.<br>
Порядок именно такой: сначала вызывается функция чтения с клавиатуры, затем вызывается функция преобразования строки в число,<br>
затем готовое число сохраняется в переменную `userAge`.<br>
Из этого также следует, что вводить мы должны теперь только целые числа, иначе программа упадет при парсинге:
```html
val userAge = readline()!!.toInt()
```
Отлично, потестим.<br>
Теперь введенное число будет сравниваться в конструкции `if`.<br> 
В зависимости от результата сравнения `true` или `false` исполнять или не исполнять код внутри фигурных скобок:
```html
if(userAge >= AGE_OF_MAJORITY) {
    println("Показать экран со скрытым контентом")
} else {
    println("Вернуться на главный экран приложения")
}
```
То есть, если `userAge` содержит любое число менее 18, выполнится блок `else`.<br>
`else` работает, только в паре с блоком `if`.

Бывает, что нужно добавить еще одно условие `if`, чтобы сделать дополнительную проверку.<br>
Сделаем это с помощью конструкции `else if`. Ее можно озвучить как “еще если”.<br>
Для примера добавим дополнительное условие.<br>
Если возраст пользователя равен 16 или 17 – печатать в консоль фразу “Показать экран с ограниченным контентом”:
```html
if(userAge >= AGE_OF_MAJORITY) {
    println("Показать экран со скрытым контентом")
} else if(userAge == 16 || userAge == 17) {
    println("Показать экран с ограниченным контентом")
} else {
    println("Вернуться на главный экран приложения")
}
```
Протестируем программу с разными значениями.<br>
Программа будет построчно сверху вниз проверять условия в круглых скобках на истину или ложь.<br>
Как только одно из условий будет `true`, выполнится код внутри фигурных скобок и программа перестанет проверять оставшиеся блоки.<br>
Зафиксируем: программа выйдет из блоков проверок, когда встретит в одном из блоков истину или, <br>
не встретив такого, закончит свое выполнение после отработки блока `else`.

Еще пара нюансов, касаемых формы написания.<br>
Первое: Если в фигурных скобках содержится только одна строчка кода, то фигурные скобки можно опустить.<br>
Это ухудшит читабельность по началу, но сократит запись. Выглядеть это может так:
```html
if(userAge >= AGE_OF_MAJORITY) {
    println("Показать экран со скрытым контентом")
} else if(userAge == 16 || userAge == 17) {
    println("Показать экран с ограниченным контентом")
} else {
    println("Вернуться на главный экран приложения")
}
```
Второе. Можно еще больше сократить запись условия с одной строчкой в теле, написав его в одну строку.<br>
Логика работы не изменится.<br>
В одной строке можно писать и `if` и `else` условия вместе, однако, мы следим за качеством оформления кода<br>
и ввиду наших длинных условий оставим в таком виде.

Отлично. Есть еще одна особенность языка Котлин.<br>
Конструкции if else могут возвращать какие-то значения. Что это значит.<br>
Например, текст, который сейчас мы печатаем в консоль можно записать в отдельную переменную, <br>
и распечатать ее после блоков с уловиями один раз. <br>
Первое, что приходит на ум, можно помещать текст в переменную в самом блоке фигурных скобок, <br>
но это, в целом, и так может быть очевидно.

Сделаем лучше. Создадим переменную `resultText` и проинициализируем ее написанным выражением `if` `else`.<br>
А действие, которое было внутри фигурных скобок (вызов println()) заменим на то самое возвращаемое значение.<br>
Проще говоря, текст из условия true запишется в переменную `resultText`.<br>
Естественно, не забываем о наличии строгой типизации.<br>
Если в одном условии возвращаем строку типа `String`, значит в остальных условиях также необходимо возвращать строку:
```html
val resultText = if (userAge >= AGE_OF_MAJORITY) "Показать экран со скрытым контентом"
else if (userAge == 16 || userAge == 17) "Показать экран с ограниченным контентом"
else "Вернуться на главный экран приложения"

println(resultText)
```
## Оператор when в Котлин
Эта конструкция сравнивает переданные ей данные со значениями, которые мы перечисляем ниже.<br>
При совпадении программа выполняет определенный код в соответствующем блоке.<br>
То есть дословно “когда” значение является “таким-то”, нужно выполнить “такой-то” код.

Для демонстрации будем проверять число `userAge`.<br>
Пишем when и в скобках какое значение будем сравнивать.<br>
Далее перечисляем значения, с которыми будем сравнивать переданное значение. Например: 10, 20, 42.<br>
Далее справа от них через специальный символ стрелки пишем инструкцию – то, что будет выполнено, <br>
если переданное значение будет равно одному из перечисленных значений.<br>
Последним значением будет блок `else` – который имеет уже знакомый смысл.<br>
Он выполнится, если ни одного совпадения не произошло. Запустим пример с разными значениями из консоли:
```html
when(userAge) {
    10 -> println("Ввели число 10")
    20 -> println("Ввели число 20")
    42 -> println("Ввели число 42")
    else -> println("Введено другое число")
}
```
Как и `if` `else`, `when` может возвращать значение.<br>
Для этого создадим переменную и проинициализируем ее значением, которое вернет when.<br> 
В этом случае также необходимо внутри убрать вызов `println()` и оставить просто возвращаемую строку:
```html
val consoleNumber = when(userAge) {
    10 -> "Ввели число 10"
    20 -> "Ввели число 20"
    42 -> "Ввели число 42"
    else -> "Введено другое число"
}

println(consoleNumber)
```
Стоит добавить, что в блоках перечисления можно также писать многострочные конструкции, но обязательно в фигурных скобках.<br>
Также как это работает с конструкцией `if else`.<br>
Например, добавим еще какое-нибудь действие, прежде, чем будет возвращена строка:
```html
val consoleNumber = when(userAge) {
    10 -> {
            println("Дополнительное действие, если ввели 10")
            "Ввели число 10"
        }
    20 -> "Ввели число 20"
    42 -> "Ввели число 42"
    else -> "Введено другое число"
}

println(consoleNumber)

Вывод в консоль:
10
Дополнительное действие, если ввели 10
Ввели число 10
```
В этом случае инструкция в подходящем блоке будет выполняться построчно сверху вниз.<br>
Сначала распечатается в консоль информация о дополнительном действии, затем в переменную `consoleNumber`<br>
вернется и запишется строка о том, что введено число 10. <br>
Наконец, переменная с этой строкой будет распечатана в методе `println()` за пределами конструкции.

Передавать на сравнение и перечисление в конструкцию when можно как базовые типы `Int, String, Boolean` и так далее, <br>
так и объекты, о которых мы будем говорить немного позже.
---
### Тест по уроку:<br>
Вопрос 1<br>
Какого оператора сравнения нет в Kotlin?<br>
```
1️⃣ <=
2️⃣ =>
3️⃣ !==
4️⃣ >=
```
Ответ: 2<br>
Оператора => нет, правильно писать >=
---
Вопрос 2:<br>
Может ли выражение if-else быть использовано как возвращающее результат выражение?<br>
```
1️⃣ Может, в любом виде   
2️⃣ Не может   
3️⃣ Может, но только при отсутствии ветки else   
4️⃣ Может, но только при наличии ветки else
```
Ответ: 4<br>
Наличие ветки else обязательно при использовании `if-else` в качестве возвращающего результат выражения, <br>
так как в любом случае какое-то значение должно быть возвращено.<br>
Это касается и вложенных `if-else`.
---
Вопрос 3<br>
Какая из этих записей неправильная?<br>
```html
val a = 4   

1️⃣  
val b = if (a &lt; 5) 5 
else a  
2️⃣  
val b: Int 
if (a &lt; 5) b = 5 
else b = a  
3️⃣  
val b = if (a &lt; 5) 5 
else if (a &gt;= 5) a  
4️⃣  
val b = if (a &lt; 5) { 
  println("a &lt; 5") 
  5 
} else { 
  println("a &gt;= 5") 
  a 
}
```
Ответ: 3<br>
Этот вариант (3) неправильный, потому что при использовании `if-else` в качестве возвращающего результат выражения<br>
нужно обязательно указывать ветку `else`.
---
Вопрос 4<br>
В каком случае фигурные скобки после if и/или else можно опустить?<br>
```
1️⃣ Если тело ветки состоит из одного выражения   
2️⃣ Если тело ветки не содержит выражений   
3️⃣ Если if-else используется для объявления переменной   
4️⃣ Если тело ветки состоит из нескольких выражений
```
Ответ: 1<br>
Фигурные скобки можно опустить только если тело ветки состоит из одного выражения.<br>
В таком случае вместо:  
```html
if (true) {
expression
}
```
можно записать:
```
if (true) expression
```
---
Вопрос 5<br>
Какое выражение возвращается, если использовать if-else в качестве возвращающего результат выражения<br>
и в самой ветке несколько выражений?   
```
1️⃣ Первое   
2️⃣ Последнее   
3️⃣ Какое выберешь   
4️⃣ При объявлении переменной в ветках может быть только по одному выражению
```
Ответ: 2<br>
Последнее выражение возвращается при использовании if для объявления переменной, то есть при записи:
```html
val c = if (a &gt; b) {
println("a &gt; b")
a
} else {
println("b &gt; a")
b
}
```


в переменную c будет записано либо a, если a &gt; b, а иначе b.

---
Вопрос 6<br>
Может ли выражение when быть использовано как возвращающее результат выражение?
```
1️⃣ Может, в любом виде   
2️⃣ Не может   
3️⃣ Может, но только при отсутствии ветки else (за некоторыми исключениями)   
4️⃣ Может, но только при наличии ветки else (за некоторыми исключениями)
```
Ответ 4:<br>
Здесь так же как и с if-else.<br>
При использовании when как возвращающего результат выражения обязательна ветка else.
---
Вопрос 7<br>
В каком случае выражение when можно использовать без аргумента?
```
1️⃣ Если в when только две ветки
2️⃣ Если when используется как возвращающее результат выражение
3️⃣ Если when заменяет цепочку if-else if, а условия работают как простые логические выражения
4️⃣ Если when используется как оператор
```
Ответ: 3<br>
В Kotlin желательно вместо цепочки `if-else if` использовать when без аргумента.<br>
Он будет работать так же как и цепочка `if-else if`.<br>
Тело первой ветки, значение логического выражения которой будет истинным, будет выполнена.
---
Вопрос 8<br>
Какая из записей неверна?
```html
val a = (Math.random() * 4).toInt()

1️⃣  
val b = when (a) {  
&gt;= 3 -&gt; 5  
&gt;= 1 -&gt; 3
else -&gt; 1
}
2️⃣  
val b = when (a) {
3, 4 -&gt; 5
1, 2 -&gt; 3
else -&gt; 1
}
3️⃣  
val b = when {
a &gt; 3 -&gt; 5
a &gt; 1 -&gt; 3
else -&gt; 1
}
4️⃣  
val b = if (a &gt; 3) 5
else if (a &gt; 1) 3
else 1
```
Ответ: 1<br>
Первая запись не верна, так как внутри оператора when нельзя разделять логические выражения с операторами сравнения, <br>
нужно использовать цельные, как например в варианте 3.
---
Вопрос 9<br>
Обязательны ли фигурные скобки после else внутри оператора when?
```
1️⃣ Обязательны только если фигурные скобки есть и в остальных ветках
2️⃣ Необязательны, если внутри блока находится несколько выражений, в противном случае обязательны
3️⃣ Обязательны, если внутри блока находится несколько выражений, в противном случае необязательны
4️⃣ Не обязательны ни в каком из случаев, фигурные скобки нужны только для повышения читаемости кода
```
Ответ: 3<br>
Фигурные скобки после `else`, как и в любых других ветках, обязательно использовать только если эта ветка содержит несколько выражений.<br>
Если же в ветке только одно выражение, то как и с оператором `if-else` фигурные скобки можно опустить.
---
Вопрос 10<br>
Можно ли в условиях `when` использовать выражения?<br>
То есть можно ли записывать так:
```html
val x = 5
val s = "5"
when (x) {
s.toInt() -&gt; print("x == s.toInt()")
else -&gt; print("x != s.toInt()")
}

1️⃣ Нет, нельзя, в условиях могут быть только переменные
2️⃣ Да, можно
3️⃣ Можно, только если when используется как оператор
4️⃣ Можно, только если when используется как возвращающее результат выражение
```
Ответ: 2<br>
В условиях веток `when` могут быть как переменные, так и выражения. <br>
`when` позволяет использовать выражения, <br>
которые возвращают результат такого же типа, как и аргумент `when` или переменные такого же типа, <br>
либо логические выражения если аргумента нет.